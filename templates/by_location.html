{% extends 'base.html' %}
{% block content %}

    <h3 class="cyan-text text-darken-2 center-align">Datasets by Location</h3>

    <h5 class="cyan-text text-darken-2 center-align">All Datasets in: {{location}}</h5>

    <!-- List: query datasets by location -->
    <ul class="collapsible popout">
        {% for dataset in datasets %}
        <li>

            <!-- Collapsible Head -->
            <div class="collapsible-header white-text cyan darken-2 text-shadow">
                <div class="col s1">
                    <i class="fas fa-caret-down"></i>
                </div>
                <!-- Dataset name and "if to do" exclamation warning -->
                <div class="col s-8">
                    <div class="name-header">
                        <strong>{{ dataset.dataset_name }}</strong>
                        {% if dataset.is_todo == "On" %}
                            <i class="fas fa-exclamation-circle green-text text-lighten-2 tooltipped todo-alert"
                            data-position="right" data-tooltip="To Do!"></i>
                        {% endif %}
                    </div>
                    </div>
                    <!-- Dataset Edit Button -->
                    <!-- Only author and admin are able to edit -->
                    {% if session.user|lower == dataset.created_by|lower or session.user == "admin"|lower %}
                    <div class="col s-3">
                        <a href="{{ url_for('edit_dataset', dataset_id=dataset._id) }}" 
                        class="waves-effect waves-light btn-small blue accent-4 option-button">
                        Edit
                        </a>
                    </div>
                    {% endif %}
                </div>

                <!-- Collapsible Body -->
                <!-- Dataset description -->
                <div class="collapsible-body">
                    <p>{{ dataset.dataset_description }}</p>
                    <hr>
                    <!-- Dataset Locations -->
                    <p class="collapsible-footer">
                        <i class="fas fa-tag prefix cyan-text collapsible-footer-icon"></i> 
                        Location : {{ dataset.location_name }}  
                    </p>
                    <!-- Dataset last updated -->
                    <p class="collapsible-footer">
                        <i class="fas fa-calendar-check prefix cyan-text collapsible-footer-icon"></i> 
                        Last updated : {{ dataset.last_update }}
                    </p>
                    <!-- Dataset "is to do" (on or off) -->
                    <p class="collapsible-footer">
                        <i class="fas fa-exclamation-circle prefix cyan-text collapsible-footer-icon"></i> 
                        To do : {{ dataset.is_todo }}
                    </p>
                    <!-- Dataset author -->
                    <p class="collapsible-footer">
                        <i class="fas fa-user-edit prefix cyan-text collapsible-footer-icon"></i> 
                        Author : {{ dataset.created_by }}
                    </p>
            </div>
                
        </li>
            {% endfor %}
    </ul>

    <h5 class="cyan-text text-darken-2 center-align">The End</h5>

    <p class="center-align">
        <a href="{{ url_for('all_locations') }}" 
           class="cyan-text text-darken-4">
           Go back to all locations
        </a>
    </p>
  
{% endblock %}